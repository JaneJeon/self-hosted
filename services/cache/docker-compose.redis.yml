version: '3'

services:
  redis:
    image: redis:7.0.0-alpine
    container_name: redis
    restart: unless-stopped
    networks:
      - private
    volumes:
      - ./volumes/redis-dump:/data # default redis container dump location - check using "config get dir"
      - ./services/cache/dump.sh:/usr/local/bin/dump:ro
      - ./services/cache/restore.sh:/usr/local/bin/restore:ro
    labels:
      com.datadoghq.ad.check_names: '["redisdb"]'
      com.datadoghq.ad.init_configs: '[{}]'
      com.datadoghq.ad.instances: '[{"host": "redis", "port": 6379}]'
      com.datadoghq.ad.logs: '[{"source": "redis", "service": "redis"}]'

networks:
  private:
    external: true
